package marc

import (
	"errors"
	"fmt"
	"strconv"
)

type leaderPos int

// Positions in leader:
const (
	LeaderRecordStatus leaderPos = iota + 5
	LeaderRecordType
	LeaderBibliograhicLevel
	LeaderControlType
	LeaderCharacterEncoding
	LeaderIndicatorCount
	LeaderSubfieldCodeCount
	_ // pos 12-16: "Base adress of data"
	_
	_
	_
	_
	LeaderEncodingLevel
)

type ControlTag int

const (
	Tag000 = iota
	Tag001
	Tag002
	Tag003
	Tag004
	Tag005
	Tag006
	Tag007
	Tag008
	Tag009
)

type DataTag int

const (
	tagIllegalDataTag DataTag = iota
	_
	_
	_
	_
	_
	_
	_
	_
	_
	Tag010
	Tag011
	Tag012
	Tag013
	Tag014
	Tag015
	Tag016
	Tag017
	Tag018
	Tag019
	Tag020
	Tag021
	Tag022
	Tag023
	Tag024
	Tag025
	Tag026
	Tag027
	Tag028
	Tag029
	Tag030
	Tag031
	Tag032
	Tag033
	Tag034
	Tag035
	Tag036
	Tag037
	Tag038
	Tag039
	Tag040
	Tag041
	Tag042
	Tag043
	Tag044
	Tag045
	Tag046
	Tag047
	Tag048
	Tag049
	Tag050
	Tag051
	Tag052
	Tag053
	Tag054
	Tag055
	Tag056
	Tag057
	Tag058
	Tag059
	Tag060
	Tag061
	Tag062
	Tag063
	Tag064
	Tag065
	Tag066
	Tag067
	Tag068
	Tag069
	Tag070
	Tag071
	Tag072
	Tag073
	Tag074
	Tag075
	Tag076
	Tag077
	Tag078
	Tag079
	Tag080
	Tag081
	Tag082
	Tag083
	Tag084
	Tag085
	Tag086
	Tag087
	Tag088
	Tag089
	Tag090
	Tag091
	Tag092
	Tag093
	Tag094
	Tag095
	Tag096
	Tag097
	Tag098
	Tag099
	Tag100
	Tag101
	Tag102
	Tag103
	Tag104
	Tag105
	Tag106
	Tag107
	Tag108
	Tag109
	Tag110
	Tag111
	Tag112
	Tag113
	Tag114
	Tag115
	Tag116
	Tag117
	Tag118
	Tag119
	Tag120
	Tag121
	Tag122
	Tag123
	Tag124
	Tag125
	Tag126
	Tag127
	Tag128
	Tag129
	Tag130
	Tag131
	Tag132
	Tag133
	Tag134
	Tag135
	Tag136
	Tag137
	Tag138
	Tag139
	Tag140
	Tag141
	Tag142
	Tag143
	Tag144
	Tag145
	Tag146
	Tag147
	Tag148
	Tag149
	Tag150
	Tag151
	Tag152
	Tag153
	Tag154
	Tag155
	Tag156
	Tag157
	Tag158
	Tag159
	Tag160
	Tag161
	Tag162
	Tag163
	Tag164
	Tag165
	Tag166
	Tag167
	Tag168
	Tag169
	Tag170
	Tag171
	Tag172
	Tag173
	Tag174
	Tag175
	Tag176
	Tag177
	Tag178
	Tag179
	Tag180
	Tag181
	Tag182
	Tag183
	Tag184
	Tag185
	Tag186
	Tag187
	Tag188
	Tag189
	Tag190
	Tag191
	Tag192
	Tag193
	Tag194
	Tag195
	Tag196
	Tag197
	Tag198
	Tag199
	Tag200
	Tag201
	Tag202
	Tag203
	Tag204
	Tag205
	Tag206
	Tag207
	Tag208
	Tag209
	Tag210
	Tag211
	Tag212
	Tag213
	Tag214
	Tag215
	Tag216
	Tag217
	Tag218
	Tag219
	Tag220
	Tag221
	Tag222
	Tag223
	Tag224
	Tag225
	Tag226
	Tag227
	Tag228
	Tag229
	Tag230
	Tag231
	Tag232
	Tag233
	Tag234
	Tag235
	Tag236
	Tag237
	Tag238
	Tag239
	Tag240
	Tag241
	Tag242
	Tag243
	Tag244
	Tag245
	Tag246
	Tag247
	Tag248
	Tag249
	Tag250
	Tag251
	Tag252
	Tag253
	Tag254
	Tag255
	Tag256
	Tag257
	Tag258
	Tag259
	Tag260
	Tag261
	Tag262
	Tag263
	Tag264
	Tag265
	Tag266
	Tag267
	Tag268
	Tag269
	Tag270
	Tag271
	Tag272
	Tag273
	Tag274
	Tag275
	Tag276
	Tag277
	Tag278
	Tag279
	Tag280
	Tag281
	Tag282
	Tag283
	Tag284
	Tag285
	Tag286
	Tag287
	Tag288
	Tag289
	Tag290
	Tag291
	Tag292
	Tag293
	Tag294
	Tag295
	Tag296
	Tag297
	Tag298
	Tag299
	Tag300
	Tag301
	Tag302
	Tag303
	Tag304
	Tag305
	Tag306
	Tag307
	Tag308
	Tag309
	Tag310
	Tag311
	Tag312
	Tag313
	Tag314
	Tag315
	Tag316
	Tag317
	Tag318
	Tag319
	Tag320
	Tag321
	Tag322
	Tag323
	Tag324
	Tag325
	Tag326
	Tag327
	Tag328
	Tag329
	Tag330
	Tag331
	Tag332
	Tag333
	Tag334
	Tag335
	Tag336
	Tag337
	Tag338
	Tag339
	Tag340
	Tag341
	Tag342
	Tag343
	Tag344
	Tag345
	Tag346
	Tag347
	Tag348
	Tag349
	Tag350
	Tag351
	Tag352
	Tag353
	Tag354
	Tag355
	Tag356
	Tag357
	Tag358
	Tag359
	Tag360
	Tag361
	Tag362
	Tag363
	Tag364
	Tag365
	Tag366
	Tag367
	Tag368
	Tag369
	Tag370
	Tag371
	Tag372
	Tag373
	Tag374
	Tag375
	Tag376
	Tag377
	Tag378
	Tag379
	Tag380
	Tag381
	Tag382
	Tag383
	Tag384
	Tag385
	Tag386
	Tag387
	Tag388
	Tag389
	Tag390
	Tag391
	Tag392
	Tag393
	Tag394
	Tag395
	Tag396
	Tag397
	Tag398
	Tag399
	Tag400
	Tag401
	Tag402
	Tag403
	Tag404
	Tag405
	Tag406
	Tag407
	Tag408
	Tag409
	Tag410
	Tag411
	Tag412
	Tag413
	Tag414
	Tag415
	Tag416
	Tag417
	Tag418
	Tag419
	Tag420
	Tag421
	Tag422
	Tag423
	Tag424
	Tag425
	Tag426
	Tag427
	Tag428
	Tag429
	Tag430
	Tag431
	Tag432
	Tag433
	Tag434
	Tag435
	Tag436
	Tag437
	Tag438
	Tag439
	Tag440
	Tag441
	Tag442
	Tag443
	Tag444
	Tag445
	Tag446
	Tag447
	Tag448
	Tag449
	Tag450
	Tag451
	Tag452
	Tag453
	Tag454
	Tag455
	Tag456
	Tag457
	Tag458
	Tag459
	Tag460
	Tag461
	Tag462
	Tag463
	Tag464
	Tag465
	Tag466
	Tag467
	Tag468
	Tag469
	Tag470
	Tag471
	Tag472
	Tag473
	Tag474
	Tag475
	Tag476
	Tag477
	Tag478
	Tag479
	Tag480
	Tag481
	Tag482
	Tag483
	Tag484
	Tag485
	Tag486
	Tag487
	Tag488
	Tag489
	Tag490
	Tag491
	Tag492
	Tag493
	Tag494
	Tag495
	Tag496
	Tag497
	Tag498
	Tag499
	Tag500
	Tag501
	Tag502
	Tag503
	Tag504
	Tag505
	Tag506
	Tag507
	Tag508
	Tag509
	Tag510
	Tag511
	Tag512
	Tag513
	Tag514
	Tag515
	Tag516
	Tag517
	Tag518
	Tag519
	Tag520
	Tag521
	Tag522
	Tag523
	Tag524
	Tag525
	Tag526
	Tag527
	Tag528
	Tag529
	Tag530
	Tag531
	Tag532
	Tag533
	Tag534
	Tag535
	Tag536
	Tag537
	Tag538
	Tag539
	Tag540
	Tag541
	Tag542
	Tag543
	Tag544
	Tag545
	Tag546
	Tag547
	Tag548
	Tag549
	Tag550
	Tag551
	Tag552
	Tag553
	Tag554
	Tag555
	Tag556
	Tag557
	Tag558
	Tag559
	Tag560
	Tag561
	Tag562
	Tag563
	Tag564
	Tag565
	Tag566
	Tag567
	Tag568
	Tag569
	Tag570
	Tag571
	Tag572
	Tag573
	Tag574
	Tag575
	Tag576
	Tag577
	Tag578
	Tag579
	Tag580
	Tag581
	Tag582
	Tag583
	Tag584
	Tag585
	Tag586
	Tag587
	Tag588
	Tag589
	Tag590
	Tag591
	Tag592
	Tag593
	Tag594
	Tag595
	Tag596
	Tag597
	Tag598
	Tag599
	Tag600
	Tag601
	Tag602
	Tag603
	Tag604
	Tag605
	Tag606
	Tag607
	Tag608
	Tag609
	Tag610
	Tag611
	Tag612
	Tag613
	Tag614
	Tag615
	Tag616
	Tag617
	Tag618
	Tag619
	Tag620
	Tag621
	Tag622
	Tag623
	Tag624
	Tag625
	Tag626
	Tag627
	Tag628
	Tag629
	Tag630
	Tag631
	Tag632
	Tag633
	Tag634
	Tag635
	Tag636
	Tag637
	Tag638
	Tag639
	Tag640
	Tag641
	Tag642
	Tag643
	Tag644
	Tag645
	Tag646
	Tag647
	Tag648
	Tag649
	Tag650
	Tag651
	Tag652
	Tag653
	Tag654
	Tag655
	Tag656
	Tag657
	Tag658
	Tag659
	Tag660
	Tag661
	Tag662
	Tag663
	Tag664
	Tag665
	Tag666
	Tag667
	Tag668
	Tag669
	Tag670
	Tag671
	Tag672
	Tag673
	Tag674
	Tag675
	Tag676
	Tag677
	Tag678
	Tag679
	Tag680
	Tag681
	Tag682
	Tag683
	Tag684
	Tag685
	Tag686
	Tag687
	Tag688
	Tag689
	Tag690
	Tag691
	Tag692
	Tag693
	Tag694
	Tag695
	Tag696
	Tag697
	Tag698
	Tag699
	Tag700
	Tag701
	Tag702
	Tag703
	Tag704
	Tag705
	Tag706
	Tag707
	Tag708
	Tag709
	Tag710
	Tag711
	Tag712
	Tag713
	Tag714
	Tag715
	Tag716
	Tag717
	Tag718
	Tag719
	Tag720
	Tag721
	Tag722
	Tag723
	Tag724
	Tag725
	Tag726
	Tag727
	Tag728
	Tag729
	Tag730
	Tag731
	Tag732
	Tag733
	Tag734
	Tag735
	Tag736
	Tag737
	Tag738
	Tag739
	Tag740
	Tag741
	Tag742
	Tag743
	Tag744
	Tag745
	Tag746
	Tag747
	Tag748
	Tag749
	Tag750
	Tag751
	Tag752
	Tag753
	Tag754
	Tag755
	Tag756
	Tag757
	Tag758
	Tag759
	Tag760
	Tag761
	Tag762
	Tag763
	Tag764
	Tag765
	Tag766
	Tag767
	Tag768
	Tag769
	Tag770
	Tag771
	Tag772
	Tag773
	Tag774
	Tag775
	Tag776
	Tag777
	Tag778
	Tag779
	Tag780
	Tag781
	Tag782
	Tag783
	Tag784
	Tag785
	Tag786
	Tag787
	Tag788
	Tag789
	Tag790
	Tag791
	Tag792
	Tag793
	Tag794
	Tag795
	Tag796
	Tag797
	Tag798
	Tag799
	Tag800
	Tag801
	Tag802
	Tag803
	Tag804
	Tag805
	Tag806
	Tag807
	Tag808
	Tag809
	Tag810
	Tag811
	Tag812
	Tag813
	Tag814
	Tag815
	Tag816
	Tag817
	Tag818
	Tag819
	Tag820
	Tag821
	Tag822
	Tag823
	Tag824
	Tag825
	Tag826
	Tag827
	Tag828
	Tag829
	Tag830
	Tag831
	Tag832
	Tag833
	Tag834
	Tag835
	Tag836
	Tag837
	Tag838
	Tag839
	Tag840
	Tag841
	Tag842
	Tag843
	Tag844
	Tag845
	Tag846
	Tag847
	Tag848
	Tag849
	Tag850
	Tag851
	Tag852
	Tag853
	Tag854
	Tag855
	Tag856
	Tag857
	Tag858
	Tag859
	Tag860
	Tag861
	Tag862
	Tag863
	Tag864
	Tag865
	Tag866
	Tag867
	Tag868
	Tag869
	Tag870
	Tag871
	Tag872
	Tag873
	Tag874
	Tag875
	Tag876
	Tag877
	Tag878
	Tag879
	Tag880
	Tag881
	Tag882
	Tag883
	Tag884
	Tag885
	Tag886
	Tag887
	Tag888
	Tag889
	Tag890
	Tag891
	Tag892
	Tag893
	Tag894
	Tag895
	Tag896
	Tag897
	Tag898
	Tag899
	Tag900
	Tag901
	Tag902
	Tag903
	Tag904
	Tag905
	Tag906
	Tag907
	Tag908
	Tag909
	Tag910
	Tag911
	Tag912
	Tag913
	Tag914
	Tag915
	Tag916
	Tag917
	Tag918
	Tag919
	Tag920
	Tag921
	Tag922
	Tag923
	Tag924
	Tag925
	Tag926
	Tag927
	Tag928
	Tag929
	Tag930
	Tag931
	Tag932
	Tag933
	Tag934
	Tag935
	Tag936
	Tag937
	Tag938
	Tag939
	Tag940
	Tag941
	Tag942
	Tag943
	Tag944
	Tag945
	Tag946
	Tag947
	Tag948
	Tag949
	Tag950
	Tag951
	Tag952
	Tag953
	Tag954
	Tag955
	Tag956
	Tag957
	Tag958
	Tag959
	Tag960
	Tag961
	Tag962
	Tag963
	Tag964
	Tag965
	Tag966
	Tag967
	Tag968
	Tag969
	Tag970
	Tag971
	Tag972
	Tag973
	Tag974
	Tag975
	Tag976
	Tag977
	Tag978
	Tag979
	Tag980
	Tag981
	Tag982
	Tag983
	Tag984
	Tag985
	Tag986
	Tag987
	Tag988
	Tag989
	Tag990
	Tag991
	Tag992
	Tag993
	Tag994
	Tag995
	Tag996
	Tag997
	Tag998
	Tag999
)

func (c ControlTag) String() string {
	return fmt.Sprintf("%03d", int(c))
}

func (c DataTag) String() string {
	return fmt.Sprintf("%03d", int(c))
}

func controlTagFromString(s string) (ControlTag, error) {
	i, err := strconv.Atoi(s)
	if err != nil {
		return Tag000, err
	}
	if i >= 0 && i <= 9 {
		return ControlTag(i), nil
	}
	return Tag000, errors.New("not a control tag: " + s)
}

func dataTagFromString(s string) (DataTag, error) {
	i, err := strconv.Atoi(s)
	if err != nil {
		return tagIllegalDataTag, err
	}
	if i >= 10 && i <= 999 {
		return DataTag(i), nil
	}
	return tagIllegalDataTag, errors.New("not a data tag: " + s)
}
